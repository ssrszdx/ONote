# 网络协议

|[网络协议](http://zh.wikipedia.org/wiki/%E7%B6%B2%E7%B5%A1%E5%82%B3%E8%BC%B8%E5%8D%94%E8%AD%B0 "网络传输协议")|
| -----------------------------------------------------------------------------------------------------------------|
|[应用层](http://zh.wikipedia.org/wiki/%E5%BA%94%E7%94%A8%E5%B1%82 "应用层")|
|DHCP ([DHCP](http://zh.wikipedia.org/wiki/DHCP "DHCP") · [DHCPv6](http://zh.wikipedia.org/wiki/DHCPv6 "DHCPv6")) · [DNS](http://zh.wikipedia.org/wiki/%E5%9F%9F%E5%90%8D%E7%B3%BB%E7%BB%9F "域名系统") · [FTP](http://zh.wikipedia.org/wiki/%E6%96%87%E4%BB%B6%E4%BC%A0%E8%BE%93%E5%8D%8F%E8%AE%AE "文件传输协议") · [Gopher](http://zh.wikipedia.org/wiki/Gopher "Gopher") · [HTTP](http://zh.wikipedia.org/wiki/%E8%B6%85%E6%96%87%E6%9C%AC%E4%BC%A0%E8%BE%93%E5%8D%8F%E8%AE%AE "超文本传输协议") · [IMAP4](http://zh.wikipedia.org/wiki/IMAP "IMAP") · [IRC](http://zh.wikipedia.org/wiki/IRC "IRC") · [NNTP](http://zh.wikipedia.org/wiki/NNTP "NNTP") · [XMPP](http://zh.wikipedia.org/wiki/XMPP "XMPP") · [POP3](http://zh.wikipedia.org/wiki/POP3 "POP3") · [SIP](http://zh.wikipedia.org/wiki/%E4%BC%9A%E8%AF%9D%E5%8F%91%E8%B5%B7%E5%8D%8F%E8%AE%AE "会话发起协议") · [SMTP](http://zh.wikipedia.org/wiki/%E7%AE%80%E5%8D%95%E9%82%AE%E4%BB%B6%E4%BC%A0%E8%BE%93%E5%8D%8F%E8%AE%AE "简单邮件传输协议") · [SNMP](http://zh.wikipedia.org/wiki/%E7%AE%80%E5%8D%95%E7%BD%91%E7%BB%9C%E7%AE%A1%E7%90%86%E5%8D%8F%E8%AE%AE "简单网络管理协议") · [SSH](http://zh.wikipedia.org/wiki/Secure_Shell "Secure Shell") · [TELNET](http://zh.wikipedia.org/wiki/Telnet "Telnet") · [RPC](http://zh.wikipedia.org/wiki/%E8%BF%9C%E7%A8%8B%E8%BF%87%E7%A8%8B%E8%B0%83%E7%94%A8 "远程过程调用") · [RTCP](http://zh.wikipedia.org/wiki/%E5%AE%9E%E6%97%B6%E4%BC%A0%E8%BE%93%E6%8E%A7%E5%88%B6%E5%8D%8F%E8%AE%AE "实时传输控制协议") · [RTP](http://zh.wikipedia.org/wiki/%E5%AE%9E%E6%97%B6%E4%BC%A0%E8%BE%93%E5%8D%8F%E8%AE%AE "实时传输协议") ·[RTSP](http://zh.wikipedia.org/wiki/RTSP "RTSP") · [SDP](http://zh.wikipedia.org/wiki/%E4%BC%9A%E8%AF%9D%E6%8F%8F%E8%BF%B0%E5%8D%8F%E8%AE%AE "会话描述协议") · [SOAP](http://zh.wikipedia.org/wiki/SOAP "SOAP") · GTP · [STUN](http://zh.wikipedia.org/wiki/STUN "STUN") · [NTP](http://zh.wikipedia.org/wiki/%E7%B6%B2%E7%B5%A1%E6%99%82%E9%96%93%E5%8D%94%E8%AD%B0 "网络时间协议") · [SSDP](http://zh.wikipedia.org/wiki/%E7%AE%80%E5%8D%95%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0%E5%8D%8F%E8%AE%AE "简单服务发现协议") · [更多](http://zh.wikipedia.org/wiki/Category:%E5%BA%94%E7%94%A8%E5%B1%82%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE "Category:应用层网络协议")|
|[传输层](http://zh.wikipedia.org/wiki/%E4%BC%A0%E8%BE%93%E5%B1%82 "传输层")|
|[TCP](http://zh.wikipedia.org/wiki/%E4%BC%A0%E8%BE%93%E6%8E%A7%E5%88%B6%E5%8D%8F%E8%AE%AE "传输控制协议") · [UDP](http://zh.wikipedia.org/wiki/%E7%94%A8%E6%88%B7%E6%95%B0%E6%8D%AE%E6%8A%A5%E5%8D%8F%E8%AE%AE "用户数据报协议") · [TLS/SSL](http://zh.wikipedia.org/wiki/%E5%AE%89%E5%85%A8%E5%A5%97%E6%8E%A5%E5%B1%82 "安全套接层") · [DCCP](http://zh.wikipedia.org/wiki/DCCP "DCCP") · [SCTP](http://zh.wikipedia.org/wiki/%E6%B5%81%E6%8E%A7%E5%88%B6%E4%BC%A0%E8%BE%93%E5%8D%8F%E8%AE%AE "流控制传输协议")​[RSVP](http://zh.wikipedia.org/wiki/%E8%B5%84%E6%BA%90%E9%A2%84%E7%95%99%E5%8D%8F%E8%AE%AE "资源预留协议") · [PPTP](http://zh.wikipedia.org/wiki/%E9%BB%9E%E5%B0%8D%E9%BB%9E%E9%9A%A7%E9%81%93%E5%8D%94%E8%AD%B0 "点对点隧道协议") · [更多](http://zh.wikipedia.org/wiki/Category:%E4%BC%A0%E8%BE%93%E5%B1%82%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE "Category:传输层网络协议")|
|[网络层](http://zh.wikipedia.org/wiki/%E7%BD%91%E7%BB%9C%E5%B1%82 "网络层")|
|[IP](http://zh.wikipedia.org/wiki/%E7%BD%91%E9%99%85%E5%8D%8F%E8%AE%AE "网际协议") ([IPv4](http://zh.wikipedia.org/wiki/IPv4 "IPv4") · [IPv6](http://zh.wikipedia.org/wiki/IPv6 "IPv6")) · [ICMP](http://zh.wikipedia.org/wiki/%E4%BA%92%E8%81%94%E7%BD%91%E6%8E%A7%E5%88%B6%E6%B6%88%E6%81%AF%E5%8D%8F%E8%AE%AE "互联网控制消息协议") · [ICMPv6](http://zh.wikipedia.org/wiki/ICMPv6 "ICMPv6") · [IGMP](http://zh.wikipedia.org/wiki/%E5%9B%A0%E7%89%B9%E7%BD%91%E7%BB%84%E7%AE%A1%E7%90%86%E5%8D%8F%E8%AE%AE "因特网组管理协议") ·[IS-IS](http://zh.wikipedia.org/wiki/%E4%B8%AD%E9%97%B4%E7%B3%BB%E7%BB%9F%E5%88%B0%E4%B8%AD%E9%97%B4%E7%B3%BB%E7%BB%9F "中间系统到中间系统") · [IPsec](http://zh.wikipedia.org/wiki/IPsec "IPsec") · [BGP](http://zh.wikipedia.org/wiki/%E8%BE%B9%E7%95%8C%E7%BD%91%E5%85%B3%E5%8D%8F%E8%AE%AE "边界网关协议") · [RIP](http://zh.wikipedia.org/wiki/%E8%B7%AF%E7%94%B1%E4%BF%A1%E6%81%AF%E5%8D%8F%E8%AE%AE "路由信息协议") · [OSPF](http://zh.wikipedia.org/wiki/%E5%BC%80%E6%94%BE%E5%BC%8F%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84%E4%BC%98%E5%85%88 "开放式最短路径优先") ·[ARP](http://zh.wikipedia.org/wiki/%E5%9C%B0%E5%9D%80%E8%A7%A3%E6%9E%90%E5%8D%8F%E8%AE%AE "地址解析协议") · [RARP](http://zh.wikipedia.org/wiki/%E5%8F%8D%E5%90%91%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2%E5%8D%8F%E8%AE%AE "反向地址转换协议") · [更多](http://zh.wikipedia.org/wiki/Category:%E7%BD%91%E7%BB%9C%E5%B1%82%E5%8D%8F%E8%AE%AE "Category:网络层协议")|
|[数据链路层](http://zh.wikipedia.org/wiki/%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82 "数据链路层")|
|[Wi-Fi](http://zh.wikipedia.org/wiki/Wi-Fi "Wi-Fi")([IEEE 802.11](http://zh.wikipedia.org/wiki/IEEE_802.11 "IEEE 802.11")) · [WiMAX](http://zh.wikipedia.org/wiki/WiMAX "WiMAX")([IEEE 802.16](http://zh.wikipedia.org/wiki/IEEE_802.16 "IEEE 802.16")) ·[ATM](http://zh.wikipedia.org/wiki/%E5%BC%82%E6%AD%A5%E4%BC%A0%E8%BE%93%E6%A8%A1%E5%BC%8F "异步传输模式") · [DTM](http://zh.wikipedia.org/wiki/DTM "DTM") · [令牌环](http://zh.wikipedia.org/wiki/%E4%BB%A4%E7%89%8C%E7%8E%AF "令牌环") · [以太网路](http://zh.wikipedia.org/wiki/%E4%BB%A5%E5%A4%AA%E7%BD%91 "以太网") · [FDDI](http://zh.wikipedia.org/wiki/%E5%85%89%E7%BA%A4%E5%88%86%E5%B8%83%E5%BC%8F%E6%95%B0%E6%8D%AE%E6%8E%A5%E5%8F%A3 "光纤分布式数据接口") · [帧中继](http://zh.wikipedia.org/wiki/%E5%B8%A7%E4%B8%AD%E7%BB%A7 "帧中继") · [GPRS](http://zh.wikipedia.org/wiki/%E9%80%9A%E7%94%A8%E5%88%86%E7%BB%84%E6%97%A0%E7%BA%BF%E6%9C%8D%E5%8A%A1 "通用分组无线服务") · [EVDO](http://zh.wikipedia.org/wiki/EVDO "EVDO") · [HSPA](http://zh.wikipedia.org/wiki/%E9%AB%98%E9%80%9F%E5%B0%81%E5%8C%85%E5%AD%98%E5%8F%96 "高速封包存取") · [HDLC](http://zh.wikipedia.org/wiki/%E9%AB%98%E7%BA%A7%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E6%8E%A7%E5%88%B6 "高级数据链路控制") · [PPP](http://zh.wikipedia.org/wiki/%E7%82%B9%E5%AF%B9%E7%82%B9%E5%8D%8F%E8%AE%AE "点对点协议") · [L2TP](http://zh.wikipedia.org/wiki/%E7%AC%AC%E4%BA%8C%E5%B1%82%E9%9A%A7%E9%81%93%E5%8D%8F%E8%AE%AE "第二层隧道协议") · [ISDN](http://zh.wikipedia.org/wiki/%E7%BB%BC%E5%90%88%E4%B8%9A%E5%8A%A1%E6%95%B0%E5%AD%97%E7%BD%91 "综合业务数字网") ·[STP](http://zh.wikipedia.org/wiki/%E7%94%9F%E6%88%90%E6%A0%91%E5%8D%8F%E8%AE%AE "生成树协议") · [更多](http://zh.wikipedia.org/wiki/Category:%E9%93%BE%E8%B7%AF%E5%8D%8F%E8%AE%AE "Category:链路协议")|
|[物理层](http://zh.wikipedia.org/wiki/%E7%89%A9%E7%90%86%E5%B1%82 "物理层")|
|[以太网](http://zh.wikipedia.org/wiki/%E4%BB%A5%E5%A4%AA%E7%BD%91 "以太网") · [调制解调器](http://zh.wikipedia.org/wiki/%E8%B0%83%E5%88%B6%E8%A7%A3%E8%B0%83%E5%99%A8 "调制解调器") · [电力线通信(PLC)](http://zh.wikipedia.org/wiki/%E9%9B%BB%E5%8A%9B%E7%B7%9A%E9%80%9A%E4%BF%A1 "电力线通信") · [SONET/SDH](http://zh.wikipedia.org/wiki/%E5%90%8C%E6%AD%A5%E5%85%89%E7%BD%91%E7%BB%9C "同步光网络") · [G.709](http://zh.wikipedia.org/w/index.php?title=G.709&action=edit&redlink=1 "G.709（页面不存在）") · [光导纤维](http://zh.wikipedia.org/wiki/%E5%85%89%E5%AF%BC%E7%BA%A4%E7%BB%B4 "光导纤维") · [同轴电缆](http://zh.wikipedia.org/wiki/%E5%90%8C%E8%BD%B4%E7%94%B5%E7%BC%86 "同轴电缆") · [双绞线](http://zh.wikipedia.org/wiki/%E5%8F%8C%E7%BB%9E%E7%BA%BF "双绞线") · [更多](http://zh.wikipedia.org/wiki/Category:%E7%89%A9%E7%90%86%E5%B1%A4%E5%8D%94%E8%AD%B0 "Category:物理层协议")|

**安全套接层** （**S**ecure **S**ockets **L**ayer， **SSL** ），一种[安全协议](http://zh.wikipedia.org/wiki/%E5%AE%89%E5%85%A8%E5%8D%8F%E8%AE%AE "安全协议")，是[网景](http://zh.wikipedia.org/wiki/%E7%B6%B2%E6%99%AF "网景")公司（Netscape）在推出Web[浏览器](http://zh.wikipedia.org/wiki/%E6%B5%8F%E8%A7%88%E5%99%A8 "浏览器")首版的同时提出的，目的是为网络通信提供安全及数据[完整性](http://zh.wikipedia.org/wiki/%E5%AE%8C%E6%95%B4%E6%80%A7 "完整性")。SSL在****对网络连接进行加密。

SSL采用[公开密钥](http://zh.wikipedia.org/wiki/%E5%85%AC%E5%BC%80%E5%AF%86%E9%92%A5 "公开密钥")技术，保证两个应用间通信的**保密性**和 **可靠性** ，使客户与服务器应用之间的通信不被攻击者窃听。它在服务器和客户机两端可同时被支持，目前已成为[互联网](http://zh.wikipedia.org/wiki/%E7%B6%B2%E9%9A%9B%E7%B6%B2%E8%B7%AF "互联网")上保密通讯的 **工业标准** 。现行Web浏览器亦普遍将[HTTP](http://zh.wikipedia.org/wiki/%E8%B6%85%E6%96%87%E6%9C%AC%E4%BC%A0%E8%BE%93%E5%8D%8F%E8%AE%AE "超文本传输协议")和SSL相结合，从而实现安全通信。此协议和其继任者是[TLS](http://zh.wikipedia.org/wiki/TLS "TLS")。

## 优势

SSL协议的优势在于它是**与**​****​**协议独立无关**的。高层的应用层协议（例如：[HTTP](http://zh.wikipedia.org/wiki/%E8%B6%85%E6%96%87%E6%9C%AC%E4%BC%A0%E8%BE%93%E5%8D%8F%E8%AE%AE "超文本传输协议")、[FTP](http://zh.wikipedia.org/wiki/%E6%96%87%E4%BB%B6%E4%BC%A0%E8%BE%93%E5%8D%8F%E8%AE%AE "文件传输协议")、[Telnet](http://zh.wikipedia.org/wiki/Telnet "Telnet")等等）能透明的建立于SSL协议之上。SSL协议在应用层协议通信之前就已经完成加密算法、通信密钥的协商以及服务器认证工作。在此之后应用层协议所传送的数据都会被加密，从而保证通信的私密性。

## 过程

![](d8c56307e6b3096d7fa7afe549c130c4-20220205172737-zdzkrev.png)[http://zh.wikipedia.org/wiki/File:SSL_handshake_with_two_way_authentication_with_certificates.svg](http://zh.wikipedia.org/wiki/File:SSL_handshake_with_two_way_authentication_with_certificates.svg)[](http://zh.wikipedia.org/wiki/File:SSL_handshake_with_two_way_authentication_with_certificates.svg "放大")

双向证书认证的SSL握手过程。

以下简要介绍SSL协议的工作方式。客户端要收发几个握手信号：

1. 发送一个“ *ClientHello* ”消息，说明它支持的密码算法列表、压缩方法及最高协议版本，也发送稍后将被使用的随机数。
2. 然后收到一个“ *ServerHello* ”消息，包含服务器选择的连接参数，源自客户端初期所提供的“ *ClientHello* ”。
3. 当双方知道了连接参数，客户端与服务器交换证书（依靠被选择的公钥系统）。这些证书通常基于[X.509](http://zh.wikipedia.org/w/index.php?title=X.509&action=edit&redlink=1 "X.509（页面不存在）")，不过已有草案支持以[OpenPGP](http://zh.wikipedia.org/w/index.php?title=OpenPGP&action=edit&redlink=1 "OpenPGP（页面不存在）")为基础的证书。
4. 服务器请求客户端公钥。客户端有证书即双向身份认证，没证书时随机生成公钥。
5. 客户端与服务器通过公钥保密协商共同的主私钥（双方随机协商），这通过精心谨慎设计的[伪随机数](http://zh.wikipedia.org/wiki/%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0 "伪随机数")功能实现。结果可能使用[Diffie-Hellman](http://zh.wikipedia.org/wiki/Diffie-Hellman "Diffie-Hellman")交换，或简化的公钥加密，双方各自用私钥解密。所有其他关键数据的加密均使用这个“主密钥”。

数据传输中记录层（Record layer）用于封装更高层的HTTP等协议。记录层数据可以被随意压缩、加密，与消息验证码压缩在一起。每个记录层包都有一个**Content-Type**段用以记录更上层用的协议。

## TLS和SSL的差异

SSL（Secure Sockets Layer）是[网景](http://zh.wikipedia.org/wiki/%E7%BD%91%E6%99%AF "网景")公司（Netscape）设计的主要用于Web的安全传输协议。这种协议在Web上获得了广泛的应用。[IETF](http://zh.wikipedia.org/wiki/IETF "IETF")（www.ietf.org）将SSL作了[标准化](http://zh.wikipedia.org/wiki/%E6%A0%87%E5%87%86%E5%8C%96 "标准化")，即 **RFC2246** ，并将其称为 **TLS** （Transport Layer Security），其最新版本是 **RFC5246** ,版本1.2。从技术上讲，TLS1.0与SSL3.0的差异非常微小。

### TLS

TLS利用[密钥算法](http://zh.wikipedia.org/wiki/%E5%AF%86%E7%A0%81%E5%AD%A6 "密码学")在[互联网](http://zh.wikipedia.org/wiki/%E4%BA%92%E8%81%94%E7%BD%91 "互联网")上提供端点[身份认证](http://zh.wikipedia.org/wiki/%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81 "身份认证")与[通讯保密](http://zh.wikipedia.org/wiki/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8 "信息安全")，其基础是[公钥基础设施](http://zh.wikipedia.org/wiki/%E5%85%AC%E9%92%A5%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD "公钥基础设施")（public key infrastructure，PKI）。不过在实现的典型例子中，只有网络服务者被可靠身份验证，而其客户端则不一定。这是因为[公钥基础设施](http://zh.wikipedia.org/wiki/%E5%85%AC%E9%92%A5%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD "公钥基础设施")普遍商业运营，电子签名证书通常需要付费购买。协议的设计在某种程度上能够使[主从式架构](http://zh.wikipedia.org/wiki/%E4%B8%BB%E5%BE%9E%E5%BC%8F%E6%9E%B6%E6%A7%8B "主从式架构")应用程序通讯本身预防[窃听](http://zh.wikipedia.org/wiki/%E7%AB%8A%E8%81%BD "窃听")、[干扰](http://zh.wikipedia.org/wiki/%E5%B9%B2%E6%89%B0 "干扰")（Tampering）、和[消息伪造](http://zh.wikipedia.org/w/index.php?title=%E6%B6%88%E6%81%AF%E4%BC%AA%E9%80%A0&action=edit&redlink=1 "消息伪造（页面不存在）")。

TLS包含三个基本阶段：

1. 对等协商支援的密钥算法
2. 基于[非对称密钥](http://zh.wikipedia.org/w/index.php?title=%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%AF%86%E9%92%A5&action=edit&redlink=1 "非对称密钥（页面不存在）")的信息传输加密和身份认证、基于[PKI](http://zh.wikipedia.org/wiki/PKI "PKI")证书的[身份认证](http://zh.wikipedia.org/wiki/%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81 "身份认证")
3. 基于[对称密钥](http://zh.wikipedia.org/wiki/%E5%AF%B9%E7%A7%B0%E5%AF%86%E9%92%A5 "对称密钥")的数据传输保密

在第一阶段，客户端与服务器协商所用密码算法。 当前广泛实现的算法选择如下：

* 公钥私钥[非对称密钥](http://zh.wikipedia.org/w/index.php?title=%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%AF%86%E9%92%A5&action=edit&redlink=1 "非对称密钥（页面不存在）")保密系统：[RSA](http://zh.wikipedia.org/wiki/RSA%E5%8A%A0%E5%AF%86%E6%BC%94%E7%AE%97%E6%B3%95 "RSA加密算法")、[Diffie-Hellman](http://zh.wikipedia.org/wiki/Diffie-Hellman "Diffie-Hellman")、[DSA](http://zh.wikipedia.org/wiki/DSA "DSA")及[Fortezza](http://zh.wikipedia.org/w/index.php?title=Fortezza&action=edit&redlink=1 "Fortezza（页面不存在）")；
* 对称密钥保密系统：[RC2](http://zh.wikipedia.org/w/index.php?title=RC2&action=edit&redlink=1 "RC2（页面不存在）")、[RC4](http://zh.wikipedia.org/wiki/RC4 "RC4")、[IDEA](http://zh.wikipedia.org/wiki/IDEA "IDEA")、[DES](http://zh.wikipedia.org/wiki/DES "DES")、[Triple DES](http://zh.wikipedia.org/wiki/Triple_DES "Triple DES")、[AES](http://zh.wikipedia.org/wiki/%E9%AB%98%E7%BA%A7%E5%8A%A0%E5%AF%86%E6%A0%87%E5%87%86 "高级加密标准")以及[Camellia](http://zh.wikipedia.org/wiki/Camellia "Camellia")；
* 单向散列函数：[MD5](http://zh.wikipedia.org/wiki/MD5 "MD5")、[SHA1](http://zh.wikipedia.org/wiki/SHA_%E5%AE%B6%E6%97%8F "SHA 家族")以及[SHA256](http://zh.wikipedia.org/wiki/SHA_%E5%AE%B6%E6%97%8F "SHA 家族")。

TLS/SSL有多样的安全保护措施：

* 所有的记录层数据均被编号，用于消息验证码校验。
